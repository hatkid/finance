<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.finance.dao.ServiceLogisticsMapper">
	<select id="findById" parameterType="int" resultType="ServiceLogistics">
		SELECT *
		FROM service_logistics WHERE id=#{id,jdbcType=INTEGER}
	</select>
	<insert id="insert" parameterType="ServiceLogistics" flushCache="true"
		useGeneratedKeys="true" keyProperty="id">
		INSERT INTO
		service_logistics(companyName,registrationNumber,address,isGradeA,legalPerson,tel,email,companyType,employeesNumber,collegeOrAboveEmpNum,logisticianEmpNum,carNumber,storageType,warehouseSpace,haveInformationPlatform,haveLandDeed,areaOfLand,businessAdvantage,businessDisadvantage,mainSourceOfIncome,totalValueOfOutput,profitsTax,valueOfOutput,year,lng,lat)
		VALUES(#{companyName,jdbcType=VARCHAR},#{registrationNumber,jdbcType=VARCHAR},#{address,jdbcType=VARCHAR},#{isGradeA,jdbcType=TINYINT},#{legalPerson,jdbcType=VARCHAR},#{tel,jdbcType=VARCHAR},#{email,jdbcType=VARCHAR},#{companyType,jdbcType=CHAR},#{employeesNumber,jdbcType=SMALLINT},#{collegeOrAboveEmpNum,jdbcType=SMALLINT},#{logisticianEmpNum,jdbcType=SMALLINT},#{carNumber,jdbcType=FLOAT},#{storageType,jdbcType=VARCHAR},#{warehouseSpace,jdbcType=FLOAT},#{haveInformationPlatform,jdbcType=TINYINT},#{haveLandDeed,jdbcType=TINYINT},#{areaOfLand,jdbcType=FLOAT},#{businessAdvantage,jdbcType=VARCHAR},#{businessDisadvantage,jdbcType=VARCHAR},#{mainSourceOfIncome,jdbcType=CHAR},#{totalValueOfOutput,jdbcType=FLOAT},#{profitsTax,jdbcType=FLOAT},#{valueOfOutput,jdbcType=FLOAT},#{year,jdbcType=VARCHAR},#{lng},#{lat})
	</insert>
	<update id="update" parameterType="ServiceLogistics">
		UPDATE service_logistics SET
		lng=#{lng},lat=#{lat},companyName=#{companyName,jdbcType=VARCHAR},registrationNumber=#{registrationNumber,jdbcType=VARCHAR},address=#{address,jdbcType=VARCHAR},isGradeA=#{isGradeA,jdbcType=TINYINT},legalPerson=#{legalPerson,jdbcType=VARCHAR},tel=#{tel,jdbcType=VARCHAR},email=#{email,jdbcType=VARCHAR},companyType=#{companyType,jdbcType=CHAR},employeesNumber=#{employeesNumber,jdbcType=SMALLINT},collegeOrAboveEmpNum=#{collegeOrAboveEmpNum,jdbcType=SMALLINT},logisticianEmpNum=#{logisticianEmpNum,jdbcType=SMALLINT},carNumber=#{carNumber,jdbcType=FLOAT},storageType=#{storageType,jdbcType=VARCHAR},warehouseSpace=#{warehouseSpace,jdbcType=FLOAT},haveInformationPlatform=#{haveInformationPlatform,jdbcType=TINYINT},haveLandDeed=#{haveLandDeed,jdbcType=TINYINT},areaOfLand=#{areaOfLand,jdbcType=FLOAT},businessAdvantage=#{businessAdvantage,jdbcType=VARCHAR},businessDisadvantage=#{businessDisadvantage,jdbcType=VARCHAR},mainSourceOfIncome=#{mainSourceOfIncome,jdbcType=CHAR},totalValueOfOutput=#{totalValueOfOutput,jdbcType=FLOAT},profitsTax=#{profitsTax,jdbcType=FLOAT},valueOfOutput=#{valueOfOutput,jdbcType=FLOAT},year=#{year,jdbcType=VARCHAR}
		WHERE id=#{id,jdbcType=INTEGER}
	</update>
	<delete id="delete" parameterType="int">
		DELETE FROM service_logistics
		WHERE id=#{id,jdbcType=INTEGER}
	</delete>
	<select id="findAll" resultType="ServiceLogistics">
		SELECT * FROM service_logistics where address is not null and lng is not null and lat is not null
	</select>
	<select id="searchByPage" resultType="ServiceLogistics">
		SELECT * FROM service_logistics
		<where>
			<if test="l.companyName != null and l.companyName!=''">
				`companyName` like
				CONCAT('%',#{l.companyName,jdbcType=VARCHAR},'%')
			</if>
			<if test="l.legalPerson != null and l.legalPerson!=''">
				and `legalPerson` like
				CONCAT('%',#{l.legalPerson,jdbcType=VARCHAR},'%')
			</if>
		</where>
		limit #{pageUtil.begin},#{pageUtil.length}
	</select>
	<select id="findAllMap" resultType="ServiceLogistics">
		SELECT * FROM service_logistics
		<where>
			<if test="companyName != null and companyName!=''">
				`companyName` like
				CONCAT('%',#{companyName,jdbcType=VARCHAR},'%')
			</if>
			<if test="address != null and address!=''">
				and `address` like
				CONCAT('%',#{address,jdbcType=VARCHAR},'%')
			</if>
			<if test="tel != null and tel!=''">
				and `tel` like
				CONCAT('%',#{tel,jdbcType=VARCHAR},'%')
			</if>
		</where>
	</select>
	<select id="getCount" resultType="long">
		SELECT COUNT(*) FROM `service_logistics`
		<where>
			<if test="companyName != null and companyName!=''">
				`companyName` like
				CONCAT('%',#{companyName,jdbcType=VARCHAR},'%')
			</if>
			<if test="legalPerson != null and legalPerson!=''">
				and `legalPerson` like
				CONCAT('%',#{legalPerson,jdbcType=VARCHAR},'%')
			</if>
		</where>
	</select>
	<insert id="batchInsert" parameterType="java.util.List">  
	    insert into service_logistics (companyName,registrationNumber,address,isGradeA,legalPerson,tel,email,companyType,employeesNumber,collegeOrAboveEmpNum,logisticianEmpNum,carNumber,storageType,warehouseSpace,haveInformationPlatform,haveLandDeed,areaOfLand,businessAdvantage,businessDisadvantage,mainSourceOfIncome,totalValueOfOutput,profitsTax,valueOfOutput,year) values  
	    <foreach collection="list" item="item" index="index"  
	        separator=",">  
	        ( #{item.item0}, #{item.item1}, #{item.item2}, #{item.item3}, #{item.item4}, #{item.item5}, #{item.item6}, #{item.item7}, #{item.item8}, #{item.item9}, #{item.item10}, #{item.item11}, #{item.item12}, #{item.item13}, #{item.item14}, #{item.item15}, #{item.item16}, #{item.item17}, #{item.item18}, #{item.item19}, #{item.item20}, #{item.item21}, #{item.item22}, #{item.item23})  
	    </foreach>
  </insert> 
  
  <select id="searchDownload" resultType="java.util.Map">
		SELECT * FROM service_logistics
		<where>
			<if test="companyName != null and companyName!=''">
				`companyName` like
				CONCAT('%',#{companyName,jdbcType=VARCHAR},'%')
			</if>
			<if test="legalPerson != null and legalPerson!=''">
				and `legalPerson` like
				CONCAT('%',#{legalPerson,jdbcType=VARCHAR},'%')
			</if>
		</where>
	</select>
	
	<select id="getCountNOLocation" resultType="long">
		SELECT COUNT(*) FROM `service_logistics` where (lng is null or lat is null) and address is not null
	</select>
	
	<select id="getOne" resultType="java.util.Map">
		SELECT * FROM `service_logistics` where (lng is null or lat is null) and address is not null limit 1
	</select>
	
	<update id="updateNOLocation" parameterType="java.util.Map">
		update service_logistics set lng = #{lng} , lat = #{lat} where id = #{id}
	</update>
	
</mapper>
